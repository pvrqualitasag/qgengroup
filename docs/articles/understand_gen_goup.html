<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Understanding Creation of Genetic Groups â€¢ qgengroup</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Understanding Creation of Genetic Groups">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qgengroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/understand_gen_goup.html">Understanding Creation of Genetic Groups</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Understanding Creation of Genetic Groups</h1>
            
      
      
      <div class="hidden name"><code>understand_gen_goup.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Animals with unknown parents are to be assigned into phantom groups. Phantom groups can be defined based on</p>
<ul>
<li>selection paths (male or female),</li>
<li>year of birth of the offspring and</li>
<li>breed</li>
</ul>
<p>Possible further grouping criteria can be country or region of origin.</p>
</div>
<div id="step-by-step-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#step-by-step-analysis" class="anchor"></a>Step By Step Analysis</h2>
<p>The goal of this analysis is to understand the steps required to define genetic groups.</p>
<div id="input" class="section level3">
<h3 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h3>
<p>The input to the definition function of genetic groups is a csv-file named <code>statGenGroupOutFile</code>. That file comes out of the f90-program <code>refmtped.f90</code> which is used to re-format the pedigree. The first few lines of this file is shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">stat_gen_grp_input &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"statGenGroupOutFile"</span>, <span class="dt">package =</span> <span class="st">"qgengroup"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">tbl_gen_grp &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2</a></span>(<span class="dt">file =</span> stat_gen_grp_input, <span class="dt">skip =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Using ',' as decimal and '.' as grouping mark. Use read_delim() for more control.</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;   Land = col_character(),</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;   Rasse = col_character(),</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;   GebJahr = col_character(),</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;   SP_SB = col_double(),</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;   SP_SC = col_double(),</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;   SP_DB = col_double(),</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;   SP_DC = col_double(),</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;   SP_SX = col_logical(),</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;   SP_DX = col_logical()</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tbl_gen_grp)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; # A tibble: 6 x 9</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;   Land  Rasse GebJahr SP_SB SP_SC SP_DB SP_DC SP_SX SP_DX</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; 1 USA   HO    1950       NA     1    NA     1 NA    NA   </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; 2 USA   HO    1952        1    NA     1    NA NA    NA   </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; 3 USA   HO    1954        1    NA     1    NA NA    NA   </span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; 4 USA   HO    1955        2     1     1     1 NA    NA   </span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; 5 USA   HO    1956       NA     1    NA     1 NA    NA   </span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; 6 USA   HO    1957       NA     1    NA     1 NA    NA</span></a></code></pre></div>
<p>Starting from the left-most column, the first three columns contain <code>country</code>, <code>breed</code> and <code>year of birth</code> that specify groups of animals with unknown parents. The titles of all other columns start with <code>SP</code> which stands for selection path. These columns contain counts of animals with missing parents for the respective <code>country</code>-<code>breed</code>-<code>birthyear</code>-class given by the first three rows and the selection path specified by the column header. The selection path abbreviations are given in the table below</p>
<table class="table">
<thead><tr class="header">
<th align="left">Abbreviation</th>
<th align="left">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SP_SB</td>
<td align="left">sire of bull</td>
</tr>
<tr class="even">
<td align="left">SP_SC</td>
<td align="left">sire of cow</td>
</tr>
<tr class="odd">
<td align="left">SP_DB</td>
<td align="left">dam of bull</td>
</tr>
<tr class="even">
<td align="left">SP_DC</td>
<td align="left">dam of cow</td>
</tr>
</tbody>
</table>
<p>Hence the first row in the above input tibble means that there is a cow with a missing sire and a cow with a missing dam from the <code>US</code> with breed <code>HOL</code> and birthyear 1950.</p>
</div>
</div>
<div id="creating-groups-with-country" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-groups-with-country" class="anchor"></a>Creating Groups With Country</h2>
<p>The function <code>create_GG</code> is used to create groups that are based on year of birth, breed and country. Inside that function the input is read into a dataframe. Then the function <code>define_GG</code> is used to define the genetic groups.</p>
</div>
<div id="definition-of-genetic-groups-" class="section level2">
<h2 class="hasAnchor">
<a href="#definition-of-genetic-groups-" class="anchor"></a>Definition of Genetic Groups.</h2>
<p>In a first step different breed labels from the input file can be replaced with a common label. The mapping between the labels is specified in an input file called <code>psBreedFile</code>. A similar mapping of labels can also be done with the countries. The groupings of the breeds and the countries is only done if input files for breed- and country mappings are specified.</p>
<p>Unused factor levels are removed after the re-mapping of breeds and countries. The removal works by re-converting all columns that are of type <code>factor</code> in the original dataframe into a factor again using the function <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>. This causes un-used factor levels to be dropped.</p>
<div id="groups-on-missing-sires" class="section level3">
<h3 class="hasAnchor">
<a href="#groups-on-missing-sires" class="anchor"></a>Groups on Missing Sires</h3>
<p>A new dataframe is defined with only sire selection paths. On that reduced dataframe, the first grouping criterion used are breeds. Breeds with too low group size are separated out and put in a dummy list called <code>dummy_gg_def_list</code>. For all breeds with enough missing sires, groups are further subdivided according to country.</p>
</div>
</div>
<div id="definition-of-genetic-groups-without-country" class="section level2">
<h2 class="hasAnchor">
<a href="#definition-of-genetic-groups-without-country" class="anchor"></a>Definition of Genetic Groups Without Country</h2>
<p>The function that creates genetic groups without considering the country of origin of the animals with missing parents is called <code>define_GG_withoutCountry</code>. In this function the groupings is done over breeds and year of birth. Groups are formed in the usual way applying some specified lower limits of group sizes.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#step-by-step-analysis">Step By Step Analysis</a></li>
      <li><a href="#creating-groups-with-country">Creating Groups With Country</a></li>
      <li><a href="#definition-of-genetic-groups-">Definition of Genetic Groups.</a></li>
      <li><a href="#definition-of-genetic-groups-without-country">Definition of Genetic Groups Without Country</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marius Hodel, Urs Schuler, Sophie Kunz, Peter von Rohr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
